---
phase: 02-navigation-restructure
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - docusaurus.config.js
  - src/css/custom.css
autonomous: false

must_haves:
  truths:
    - "Navbar shows 2-3 dropdown categories instead of 6 flat items"
    - "Dropdown labels tell a journey story (understand problem -> build solution)"
    - "Active dropdown parent is visually highlighted when browsing child docs"
    - "Navbar works on mobile without overflow or broken layout"
    - "All existing doc URLs continue to work unchanged"
  artifacts:
    - path: "docusaurus.config.js"
      provides: "Dropdown navbar configuration with journey-based grouping"
      contains: "type: 'dropdown'"
    - path: "src/css/custom.css"
      provides: "Dropdown active state CSS, dark mode dropdown styling, responsive rules"
      contains: ".dropdown:has(.dropdown__link--active)"
  key_links:
    - from: "docusaurus.config.js"
      to: "docs/**/_category_.json"
      via: "docId references to existing category pages"
      pattern: "docId.*category"
    - from: "src/css/custom.css"
      to: "docusaurus.config.js"
      via: "CSS targets Infima dropdown classes generated by config"
      pattern: "\\.dropdown.*\\.navbar"
---

<objective>
Restructure the flat 6-item navbar into journey-based dropdown categories with active state indication and responsive styling.

Purpose: Visitors navigate through a clear progression story instead of choosing from a flat, overwhelming list of topics. This is the core navigation UX improvement.
Output: Updated navbar config with 2-3 dropdown groups, CSS for active states and dark mode dropdowns, responsive mobile behavior.
</objective>

<execution_context>
@/Users/ianread/.claude/get-shit-done/workflows/execute-plan.md
@/Users/ianread/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-navigation-restructure/02-RESEARCH.md
@.planning/phases/01-theme-foundation/01-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Restructure navbar to journey-based dropdown groups</name>
  <files>docusaurus.config.js</files>
  <action>
Replace the current flat `navbar.items` array (6 individual doc links) with 2 dropdown groups that tell a journey story.

**Grouping (2 categories):**

1. **"Understanding the Problem"** (dropdown, position: left)
   - Begin: `{ type: 'doc', docId: 'intro', label: 'Begin' }`
   - Product: `{ type: 'doc', docId: '/category/product', label: 'Product' }`

2. **"Building the Solution"** (dropdown, position: left)
   - Team: `{ type: 'doc', docId: '/category/building-the-team', label: 'Team' }`
   - Engineering Process: `{ type: 'doc', docId: '/category/engineering-process', label: 'Engineering Process' }`
   - AI Cookbook: `{ type: 'doc', docId: '/category/ai-engineering-cookbook', label: 'AI Cookbook' }`
   - Engineering Habits: `{ type: 'doc', docId: '/category/engineering-habits', label: 'Engineering Habits' }`

**Configuration structure:**
```javascript
items: [
  {
    type: 'dropdown',
    label: 'Understanding the Problem',
    position: 'left',
    items: [
      { type: 'doc', docId: 'intro', label: 'Begin' },
      { type: 'doc', docId: '/category/product', label: 'Product' },
    ],
  },
  {
    type: 'dropdown',
    label: 'Building the Solution',
    position: 'left',
    items: [
      { type: 'doc', docId: '/category/building-the-team', label: 'Team' },
      { type: 'doc', docId: '/category/engineering-process', label: 'Engineering Process' },
      { type: 'doc', docId: '/category/ai-engineering-cookbook', label: 'AI Cookbook' },
      { type: 'doc', docId: '/category/engineering-habits', label: 'Engineering Habits' },
    ],
  },
],
```

**Important:**
- Use `type: 'doc'` with `docId` for all internal links (not `href`) so Docusaurus auto-applies `.navbar__link--active`
- Keep exact same `docId` values as current config to preserve all existing URL routing
- Do NOT modify sidebars.js or any doc file paths — this is navbar-only
- Preserve the site title and logo configuration unchanged
- Preserve all other themeConfig unchanged (footer, prism, metadata, colorMode)
  </action>
  <verify>
Run `npm run build` (or `npx docusaurus build`) from project root — build must succeed with zero errors. Check output for any broken link warnings related to navbar items.
  </verify>
  <done>
Navbar config has exactly 2 dropdown items instead of 6 flat items. Build succeeds. All docId references resolve correctly.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add dropdown active state CSS and dark mode styling</name>
  <files>src/css/custom.css</files>
  <action>
Add CSS rules to `src/css/custom.css` for three concerns: dropdown parent active state indication, dark mode dropdown menu styling, and responsive mobile behavior.

**1. Dropdown parent active state (NAV-03):**
```css
/* Highlight dropdown parent when browsing child docs */
.navbar__item.dropdown:has(.dropdown__link--active) > .navbar__link {
  color: var(--ifm-color-primary);
}

/* Subtle underline indicator on active dropdown */
.navbar__item.dropdown:has(.dropdown__link--active) > .navbar__link::after {
  content: '';
  display: block;
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 2px;
  background-color: var(--ifm-color-primary);
  border-radius: 1px;
}

/* Ensure dropdown parent is position:relative for the underline */
.navbar__item.dropdown {
  position: relative;
}
```

**2. Dark mode dropdown menu styling:**
```css
/* Dark mode dropdown menu appearance */
[data-theme='dark'] .dropdown__menu {
  background-color: var(--ifm-background-surface-color);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 8px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
}

[data-theme='dark'] .dropdown__link {
  color: var(--ifm-navbar-link-color);
}

[data-theme='dark'] .dropdown__link:hover {
  background-color: var(--ifm-menu-color-background-hover);
  color: var(--ifm-navbar-link-hover-color);
}

[data-theme='dark'] .dropdown__link--active {
  color: var(--ifm-color-primary);
  background-color: var(--ifm-menu-color-background-active);
}
```

**3. Responsive mobile behavior:**
```css
/* Mobile responsive: prevent label overflow at 996px breakpoint */
@media (max-width: 996px) {
  .navbar__item .navbar__link {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
}
```

**Important:**
- Use only CSS variables from the theme (var(--ifm-*)) — never hardcoded colors (pattern from Phase 1)
- Use `[data-theme='dark']` selector for dark-specific overrides (pattern from Phase 1)
- Place new rules AFTER the existing global refinements section, in a clearly commented new section
- Do NOT modify any existing CSS rules from Phase 1
- The `:has()` pseudo-selector has 95%+ browser support (Safari 15.4+, Chrome 105+, Firefox 121+)
  </action>
  <verify>
Run `npm run build` — build must succeed. Visually inspect that no CSS syntax errors exist by searching for unmatched braces. Verify all color references use CSS variables, not hardcoded values.
  </verify>
  <done>
CSS file contains dropdown active state rules using `:has()`, dark mode dropdown styling using CSS variables, and mobile responsive overflow prevention. All rules use theme-aware variables.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 3: Verify navigation restructure</name>
  <files>docusaurus.config.js, src/css/custom.css</files>
  <action>
Human verification of the navigation restructure. Start dev server (`npm start`) and verify the following:

**Desktop checks:**
1. Visit http://localhost:3000
2. Verify navbar shows exactly 2 dropdown categories: "Understanding the Problem" and "Building the Solution"
3. Hover over "Understanding the Problem" — should show dropdown with "Begin" and "Product"
4. Hover over "Building the Solution" — should show dropdown with "Team", "Engineering Process", "AI Cookbook", "Engineering Habits"
5. Click "Begin" — navigate to intro page. Verify "Understanding the Problem" dropdown label is highlighted in teal/cyan
6. Click "Product" from dropdown — verify you land on the Product category page and "Understanding the Problem" stays highlighted
7. Click "Team" from "Building the Solution" dropdown — verify active state switches to "Building the Solution"
8. Click "Engineering Habits" — verify "Building the Solution" stays highlighted
9. Verify dropdown menus have dark background with subtle border (not white/light)

**Mobile check:**
10. Resize browser to less than 996px wide (or use DevTools responsive mode)
11. Verify hamburger menu appears and navbar items don't overflow horizontally
12. Open hamburger menu — verify dropdown categories appear as collapsible sections
13. Verify labels are readable and not truncated

**Regression check:**
14. Navigate to any doc page via sidebar — verify URL hasn't changed (e.g., /docs/intro still works)
15. Verify sidebar navigation still works normally within docs
  </action>
  <verify>User visually confirms all checks above pass.</verify>
  <done>Navigation shows 2 journey-based dropdown categories, active state highlighting works, mobile responsive, all existing URLs preserved. User types "approved".</done>
</task>

</tasks>

<verification>
Phase 2 complete when:
1. `npm run build` succeeds with no broken link errors
2. Navbar shows 2 dropdown groups (not 6 flat items)
3. Dropdown labels are journey-themed ("Understanding the Problem", "Building the Solution")
4. Active dropdown parent highlights in teal/cyan when browsing child docs
5. Dropdown menus styled for dark mode (dark background, light text)
6. Mobile: no horizontal overflow, hamburger menu works with collapsible dropdowns
7. All existing doc URLs unchanged and functional
</verification>

<success_criteria>
- Top-level navbar reduced from 6 flat items to 2 dropdown categories
- Navigation tells a journey story: understand the problem, then build the solution
- Active section clearly indicated via teal/cyan color on dropdown parent
- Mobile responsive without overflow at 996px breakpoint
- Zero broken links, all existing URLs preserved
</success_criteria>

<output>
After completion, create `.planning/phases/02-navigation-restructure/02-01-SUMMARY.md`
</output>
